# NimsforestOrganization - Organizational Structure Component
# Run these commands from the tools/nimsforestorganization directory

.PHONY: nimsforestorganization-hello nimsforestorganization-init nimsforestorganization-lint nimsforestorganization-addtomainmake nimsforestorganization-create-folder-structure nimsforestorganization-create-folder-structure-yml

nimsforestorganization-hello:
	@echo "=== NimsforestOrganization System Check ==="
	@echo "Checking system compatibility..."
	@command -v git >/dev/null 2>&1 || { echo "Error: git is required but not installed." >&2; exit 1; }
	@command -v make >/dev/null 2>&1 || { echo "Error: make is required but not installed." >&2; exit 1; }
	@echo "‚úì Git available"
	@echo "‚úì Make available"
	@echo ""
	@echo "Creates organizational documentation structure:"
	@echo "  ‚Ä¢ Customer value chain (marketing, sales, operations, accounting)"
	@echo "  ‚Ä¢ Strategic direction and financing (strategy, finance, governance, legal)"
	@echo "  ‚Ä¢ Three-level hierarchy for systematic intelligence capture"
	@echo ""
	@echo "Next: Run 'make nimsforestorganization-init' to create structure"

nimsforestorganization-init:
	@echo "=== NimsforestOrganization Initialization ==="
	@echo "Creating organizational structure from YAML..."
	@$(MAKE) -f $(firstword $(MAKEFILE_LIST)) nimsforestorganization-create-folder-structure

nimsforestorganization-lint:
	@echo "=== NimsforestOrganization Structure Validation ==="
	@echo "Checking organizational structure against YAML..."
	@echo ""
	@if [ -d "$${DOCS_PATH:-../../docs}/organization" ]; then \
		echo "‚úì Organization directory exists"; \
		folder_count=$$(find $${DOCS_PATH:-../../docs}/organization -type d | wc -l); \
		echo "üìÅ Total folders: $$folder_count"; \
		echo ""; \
		if [ -f "organization-structure.yml" ]; then \
			echo "Validating against organization-structure.yml:"; \
			failed=0; \
			while IFS= read -r line; do \
				if echo "$$line" | grep -q "^  [a-z-]*:$$"; then \
					category=$$(echo "$$line" | sed 's/^  //; s/:$$//'); \
				elif echo "$$line" | grep -q "^    [a-z-]*:$$"; then \
					dept=$$(echo "$$line" | sed 's/^    //; s/:$$//'); \
				elif echo "$$line" | grep -q "^      - "; then \
					subdir=$$(echo "$$line" | sed 's/^      - //'); \
					path="$${DOCS_PATH:-../../docs}/organization/$$category/$$dept/$$subdir"; \
					if [ -d "$$path" ]; then \
						echo "  ‚úì $$category/$$dept/$$subdir"; \
					else \
						echo "  ‚úó $$category/$$dept/$$subdir missing"; \
						failed=1; \
					fi; \
				fi; \
			done < organization-structure.yml; \
			if [ $$failed -eq 1 ]; then \
				echo ""; \
				echo "‚ùå Structure validation failed"; \
				exit 1; \
			else \
				echo ""; \
				echo "‚úÖ All directories from YAML exist"; \
			fi; \
		else \
			echo "‚úó organization-structure.yml not found"; \
		fi; \
	else \
		echo "‚úó Organization structure not found. Run 'make nimsforestorganization-init' first."; \
	fi

nimsforestorganization-addtomainmake:
	@echo "=== Adding NimsforestOrganization to main Makefile ==="
	@if [ ! -f Makefile ]; then \
		echo "Creating main Makefile..."; \
		echo "-include MAKEFILE.nimsforestorganization" > Makefile; \
	else \
		if ! grep -q "MAKEFILE.nimsforestorganization" Makefile; then \
			echo "Adding include to existing Makefile..."; \
			echo "-include MAKEFILE.nimsforestorganization" >> Makefile; \
		else \
			echo "‚úì Already included in Makefile"; \
		fi; \
	fi
	@echo "‚úì NimsforestOrganization targets available via main Makefile"

nimsforestorganization-create-folder-structure:
	@echo "Processing organization-structure.yml..."
	@if [ -f "organization-structure.yml" ]; then \
		echo "Using existing organization-structure.yml"; \
	else \
		echo "Creating default organization-structure.yml"; \
		$(MAKE) -f $(firstword $(MAKEFILE_LIST)) nimsforestorganization-create-folder-structure-yml; \
	fi
	@echo "Creating directory structure..."
	@mkdir -p $${DOCS_PATH:-../../docs}/organization
	@echo "# Organization" > $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "Organizational documentation structure created from organization-structure.yml" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "## Structure" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "Creating customer value chain structure..."
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/marketing/target-audiences
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/marketing/messaging
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/marketing/channels
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/marketing/campaigns
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/sales/pipeline
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/sales/qualification
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/sales/territories
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/sales/processes
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/operations/processes
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/operations/quality
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/operations/supply-chain
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/operations/delivery
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/accounting/reporting
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/accounting/analysis
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/accounting/compliance
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/customer-value-chain/accounting/budgeting
	@echo "Creating strategic direction and financing structure..."
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/strategy/planning
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/strategy/objectives
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/strategy/analysis
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/strategy/roadmaps
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/finance/budgeting
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/finance/forecasting
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/finance/investments
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/finance/reporting
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/governance/policies
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/governance/procedures
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/governance/risk-management
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/governance/compliance
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/legal/contracts
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/legal/intellectual-property
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/legal/regulatory
	@mkdir -p $${DOCS_PATH:-../../docs}/organization/strategic-direction-and-financing/legal/disputes
	@echo "- **customer-value-chain/** - Core value delivery functions" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "- **strategic-direction-and-financing/** - Strategic planning and financial management" >> $${DOCS_PATH:-../../docs}/organization/README.md
	@echo "‚úì Organizational structure created from YAML"

nimsforestorganization-create-folder-structure-yml:
	@echo "organization:" > organization-structure.yml
	@echo "  customer-value-chain:" >> organization-structure.yml
	@echo "    description: Core value delivery functions" >> organization-structure.yml
	@echo "    marketing:" >> organization-structure.yml
	@echo "      - target-audiences" >> organization-structure.yml
	@echo "      - messaging" >> organization-structure.yml
	@echo "      - channels" >> organization-structure.yml
	@echo "      - campaigns" >> organization-structure.yml
	@echo "    sales:" >> organization-structure.yml
	@echo "      - pipeline" >> organization-structure.yml
	@echo "      - qualification" >> organization-structure.yml
	@echo "      - territories" >> organization-structure.yml
	@echo "      - processes" >> organization-structure.yml
	@echo "    operations:" >> organization-structure.yml
	@echo "      - processes" >> organization-structure.yml
	@echo "      - quality" >> organization-structure.yml
	@echo "      - supply-chain" >> organization-structure.yml
	@echo "      - delivery" >> organization-structure.yml
	@echo "    accounting:" >> organization-structure.yml
	@echo "      - reporting" >> organization-structure.yml
	@echo "      - analysis" >> organization-structure.yml
	@echo "      - compliance" >> organization-structure.yml
	@echo "      - budgeting" >> organization-structure.yml
	@echo "  strategic-direction-and-financing:" >> organization-structure.yml
	@echo "    description: Strategic planning and financial management" >> organization-structure.yml
	@echo "    strategy:" >> organization-structure.yml
	@echo "      - planning" >> organization-structure.yml
	@echo "      - objectives" >> organization-structure.yml
	@echo "      - analysis" >> organization-structure.yml
	@echo "      - roadmaps" >> organization-structure.yml
	@echo "    finance:" >> organization-structure.yml
	@echo "      - budgeting" >> organization-structure.yml
	@echo "      - forecasting" >> organization-structure.yml
	@echo "      - investments" >> organization-structure.yml
	@echo "      - reporting" >> organization-structure.yml
	@echo "    governance:" >> organization-structure.yml
	@echo "      - policies" >> organization-structure.yml
	@echo "      - procedures" >> organization-structure.yml
	@echo "      - risk-management" >> organization-structure.yml
	@echo "      - compliance" >> organization-structure.yml
	@echo "    legal:" >> organization-structure.yml
	@echo "      - contracts" >> organization-structure.yml
	@echo "      - intellectual-property" >> organization-structure.yml
	@echo "      - regulatory" >> organization-structure.yml
	@echo "      - disputes" >> organization-structure.yml